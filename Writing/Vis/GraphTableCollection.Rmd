---
title: "GraphTableCollection"
author: "Robert Petit"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source("../../Code/include.R", local=TRUE)
WorkoutData = read_csv(here("Data/Workouts.csv"))

CURRENTWEEK = 2
```


``` {r BuildStats}
# Generates all of the stats

MilesCovered_Total <- WorkoutData %>% summarize(Covered = sum(FrodoMiles)) %>% pull(Covered)
MilesCovered_Weekly <- WorkoutData %>% filter(Week == CURRENTWEEK) %>% summarize(Covered = sum(FrodoMiles)) %>% pull(Covered)
MilesCovered_LastWeek <- WorkoutData %>% filter(Week == CURRENTWEEK-1) %>% summarize(Covered = sum(FrodoMiles)) %>% pull(Covered)

WD_Stats <- WorkoutData %>% Stats_PerPerson(CURRENTWEEK)

WeeklyFrodo <- WD_Stats %>% arrange(desc(WeeklyDistance)) %>% head(1)
WeeklySam <- WD_Stats %>% arrange(desc(WeeklyTime)) %>% head(1)
```

# Leaderboards
```{r FMLeader}
WD_Stats %>%
  select(Name, TotalDistance) %>%
  arrange(desc(TotalDistance)) %>%
  kable(col.names = c("Names", "Frodo Miles"),
        caption = "Total Frodo Miles")
```

```{r FMWeeklyLeader}
WD_Stats %>%
  select(Name, WeeklyDistance) %>%
  filter(WeeklyDistance>0) %>%
  arrange(desc(WeeklyDistance)) %>%
  kable(col.names = c("Names", "Frodo Miles"),
        caption = "Weekly Frodo Miles")
```

```{r MilesByDay_Weekly}
WorkoutData %>%
  filter(Week==CURRENTWEEK) %>%
  group_by(Day) %>%
  summarize(DayFM = sum(FrodoMiles)) %>%
  ggplot(mapping=aes(
    x = factor(Day, levels=c("Su", "M", "Tu", "W", "Th", "F", "Sa")),
    y = DayFM,
    fill=Day)) +
  geom_col() +
  scale_fill_brewer(type="qual", palette=6) +
  labs(
    title = "Group Miles By Day, This Week",
    x="Day",
    y="Frodo Miles"
  )
```
